<!DOCTYPE html>
<html lang="pt-br">

<head>

    <meta charset="UTF-8">

    <!-- Fornecer uma descrição breve e precisa da página, que pode ser exibida nos resultados de pesquisa como o trecho (snippet) abaixo do título. -->
    <meta name="description"
        content="Conheça Les Vignes d’Or, vinhos artesanais da França direto para você. Explore nossa coleção e compre online com segurança.">

    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <title>Les Vignes d’Or – Vinhos Artesanais da França | Loja Oficial</title>

    <!-- Importação de arquivos de estilo -->

    <link rel="stylesheet" href="{{ url_for('static', filename='css/home.css') }}">
    <link rel="stylesheet" href="{{ url_for('static', filename='css/config.css') }}">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.6/dist/css/bootstrap.min.css" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.6/dist/js/bootstrap.bundle.min.js" defer></script>

    <!-- Importação do framework "font awesome" -->

    <script src="https://kit.fontawesome.com/8991f246e8.js" crossorigin="anonymous"></script>

    <!-- Importação do framework "bootstrap" -->



    <!-- Importação da fonte do google -->



</head>

<body>

<header class="header">

    <div class="header__store-name header__main-left">

        <form action="{{ url_for('main_page') }}" method="get" id="filter-form" class="category-filter">

            <select name="categoria" class="header__main-category-select" onchange="this.form.submit()">

                <option value="" {% if not request.args.get('categoria') %}selected{% endif %}>Todas as Categorias
                </option>

                {% for categoria in categorias %}

                <option value="{{ categoria.id_categoria }}" {% set
                    selected_category_id=request.args.get('categoria') %} {% if selected_category_id is not none and
                    selected_category_id is not string and selected_category_id|int==categoria.id_categoria %}
                    selected {% elif selected_category_id is string and
                    selected_category_id|int(default=-1)==categoria.id_categoria %} selected {% endif %}>
                    {{ categoria['nome'] }}
                </option>

                {% endfor %}

            </select><!--header__main-category-select-->

        </form><!--category-filter-->

    </div><!--header__section header__section--left-->

    <div class="header__store-name header__center">

        <a href="{{ url_for('main_page') }}" class="header__brand">Les Vignes d’Or</a>

    </div><!--header__store-name header__store--center-->

    <div class="header__store-name header__main-right">

        {% if 'user_id' in session %}

        <a href="{{ url_for('logout') }}" class="header__icon-link" title="Sair ({{ session.username }})">

            <i class="fas fa-sign-out-alt"></i>

        </a><!--header__icon-link-->

        {% else %}

        <a href="{{ url_for('create_acount') }}" class="header__icon-link" title="Entrar / Criar Conta">

            <i class="fas fa-user-circle"></i>

        </a><!--header__icon-link-->

        {% endif %}

        <a href="{{ url_for('carrinho') }}" class="header__icon-link" title="Carrinho">

            <i class="fas fa-shopping-cart"></i>

        </a><!--header__icon-link-->

    </div><!--header__section header__section--right-->

</header><!--header-->

        <main>

            <section class="store">

                {% with messages = get_flashed_messages(with_categories=true) %}
                    {% if messages %}
                        {% for category, message in messages %}

                            <p class="alert alert-{{ category }}" role="alert">{{ message }}</p>

                        {% endfor %}
                    {% endif %}
                {% endwith %}

                
            <div id="carouselExample" class="carousel slide store__carousel-container">
                <div class="carousel-inner store__carousel-inner">
                    <div class="carousel-item active">
                    <img src="..." class="d-block w-100 store__carousel-image" alt="...">
                    </div>
                    <div class="carousel-item">
                    <img src="..." class="d-block w-100 store__carousel-image" alt="...">
                    </div>
                    <div class="carousel-item">
                    <img src="..." class="d-block w-100 store__carousel-image" alt="...">
                    </div>
                </div>
                <button class="carousel-control-prev store__carousel-control--prev" type="button" data-bs-target="#carouselExample" data-bs-slide="prev">
                    <span class="carousel-control-prev-icon" aria-hidden="true"></span>
                    <span class="visually-hidden">Previous</span>
                </button>
                <button class="carousel-control-next store__carousel-control--next" type="button" data-bs-target="#carouselExample" data-bs-slide="next">
                    <span class="carousel-control-next-icon" aria-hidden="true"></span>
                    <span class="visually-hidden">Next</span>
                </button>
            </div>
                
                <h1 class="store__title">Nossos Vinhos</h1>

                <div class="store__grid">
                    {# Loop sobre 'produtos' (que são os vinhos), conforme passado pelo Flask #}
                    
                    {% for vinho in produtos %}

                    <article class="product-card">

                        <img src="{{ vinho.imagem_url }}" alt="{{ vinho.nome }}" class="product-card__image">
                        <h3 class="product-card__name">{{ vinho.nome }}</h3>
                        <p class="product-card__description">{{ vinho.descricao }}</p>
                        <p class="product-card__price">R$ {{ '%.2f'|format(vinho.preco) }}</p>
                        <a href="{{ url_for('detalhes_vinho', vinho_id=vinho.id_produto) }}"
                            class="product-card__details-button">Ver Detalhes</a>

                    </article><!--product-card-->

                    {% else %}

                    <p class="store__error-message">Nenhum vinho encontrado.</p>

                    {% endfor %}

                </div><!--store__grid-->

            </section><!--store-->

        </main>
    {% endblock %}

</body>

</html>